{% extends 'base.html' %}
{% load static %}

{% block title %}Backpacking Gear â€” Rent or Buy{% endblock %}

{% block extra_css %}
<link href="{% static 'assets/css/bag-packing.css' %}" rel="stylesheet">

{% endblock %}

{% block content %}

<div class="page-wrapper">
    <!-- HERO -->
    <div class="page-hero">
        <h1>Backpacking Gear â€” Rent or Buy</h1>
        <p>Your essential travel items for trekking, camping & long trips.</p>
    </div>

    <!-- FILTER BAR -->
    <div class="filter-bar">
        <div class="filter-tabs" id="filterTabs">
            <div class="filter-tab active" data-filter="all">All</div>
            <div class="filter-tab" data-filter="backpacks">Backpacks</div>
            <div class="filter-tab" data-filter="sleeping">Sleeping Gear</div>
            <div class="filter-tab" data-filter="electronics">Electronics</div>
            <div class="filter-tab" data-filter="cooking">Cooking</div>
            <div class="filter-tab" data-filter="safety">Safety</div>
            <div class="filter-tab" data-filter="essentials">Essentials</div>
        </div>

        <div class="d-flex">
            <div class="toggle-btn active mx-1" id="btnRent">Rent</div>
            <div class="toggle-btn mx-1" id="btnBuy">Buy</div>
        </div>

        <select class="sort-select" id="sortSelect">
            <option value="popular">Most Popular</option>
            <option value="low">Price: Low â†’ High</option>
            <option value="high">Price: High â†’ Low</option>
            <option value="new">Newest</option>
        </select>
    </div>

    <!-- PRODUCT GRID -->
    <div class="product-grid" id="productGrid">

        <!-- ðŸ”¥ STATIC PRODUCT LIST BELOW -->

        <!-- Backpacks -->
        <article class="product-card" data-cat="backpacks" data-id="bp1">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p1.jpg' %}" alt="">
                <div class="prod-badge">Backpacks</div>
                <button class="view-btn" data-id="bp1">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">55L Trekking Backpack</div>
                <div class="product-cat">Waterproof â€¢ Hiking</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹599</span> <span class="prod-old">â‚¹899</span></div>
                    <div class="rating">â˜… 4.7 (143)</div>
                </div>
            </div>
        </article>

        <article class="product-card" data-cat="backpacks" data-id="bp2">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p2.jpg' %}" alt="">
                <div class="prod-badge">Backpacks</div>
                <button class="view-btn" data-id="bp2">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">35L Travel Daypack</div>
                <div class="product-cat">Lightweight â€¢ Anti-theft</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹349</span> <span class="prod-old">â‚¹549</span></div>
                    <div class="rating">â˜… 4.6 (98)</div>
                </div>
            </div>
        </article>

        <!-- Sleeping Gear -->
        <article class="product-card" data-cat="sleeping" data-id="sl1">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p1.jpg' %}" alt="">
                <div class="prod-badge">Sleeping Gear</div>
                <button class="view-btn" data-id="sl1">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">Mummy Sleeping Bag</div>
                <div class="product-cat">-5Â°C | Winter-ready</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹299</span> <span class="prod-old">â‚¹499</span></div>
                    <div class="rating">â˜… 4.8 (211)</div>
                </div>
            </div>
        </article>

        <article class="product-card" data-cat="sleeping" data-id="sl2">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p2.jpg' %}" alt="">
                <div class="prod-badge">Sleeping Gear</div>
                <button class="view-btn" data-id="sl2">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">Self-Inflatable Sleeping Mat</div>
                <div class="product-cat">Comfort + Insulation</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹249</span> <span class="prod-old">â‚¹399</span></div>
                    <div class="rating">â˜… 4.5 (132)</div>
                </div>
            </div>
        </article>

        <!-- Electronics -->
        <article class="product-card" data-cat="electronics" data-id="el1">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p4.jpg' %}" alt="">
                <div class="prod-badge">Electronics</div>
                <button class="view-btn" data-id="el1">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">20000mAh Powerbank</div>
                <div class="product-cat">Fast Charging</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹249</span> <span class="prod-old">â‚¹449</span></div>
                    <div class="rating">â˜… 4.6 (440)</div>
                </div>
            </div>
        </article>

        <article class="product-card" data-cat="electronics" data-id="el2">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p1.jpg' %}" alt="">
                <div class="prod-badge">Electronics</div>
                <button class="view-btn" data-id="el2">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">Action Camera Kit</div>
                <div class="product-cat">4K â€¢ Waterproof</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹899</span> <span class="prod-old">â‚¹1399</span></div>
                    <div class="rating">â˜… 4.8 (88)</div>
                </div>
            </div>
        </article>

        <!-- Cooking -->
        <article class="product-card" data-cat="cooking" data-id="ck1">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p6.jpg' %}" alt="">
                <div class="prod-badge">Cooking</div>
                <button class="view-btn" data-id="ck1">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">Portable Camping Stove</div>
                <div class="product-cat">Compact â€¢ Lightweight</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹249</span> <span class="prod-old">â‚¹399</span></div>
                    <div class="rating">â˜… 4.5 (112)</div>
                </div>
            </div>
        </article>

        <article class="product-card" data-cat="cooking" data-id="ck2">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p5.jpg' %}" alt="">
                <div class="prod-badge">Cooking</div>
                <button class="view-btn" data-id="ck2">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">Titanium Cookset</div>
                <div class="product-cat">2-piece Ultralight</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹299</span> <span class="prod-old">â‚¹479</span></div>
                    <div class="rating">â˜… 4.7 (55)</div>
                </div>
            </div>
        </article>

        <!-- Safety -->
        <article class="product-card" data-cat="safety" data-id="sf1">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p6.jpg' %}" alt="">
                <div class="prod-badge">Safety</div>
                <button class="view-btn" data-id="sf1">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">Multi-Use Survival Knife</div>
                <div class="product-cat">Firestarter â€¢ Steel Blade</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹199</span> <span class="prod-old">â‚¹349</span></div>
                    <div class="rating">â˜… 4.4 (178)</div>
                </div>
            </div>
        </article>

        <article class="product-card" data-cat="safety" data-id="sf2">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p4.jpg' %}" alt="">
                <div class="prod-badge">Safety</div>
                <button class="view-btn" data-id="sf2">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">LED Headlamp</div>
                <div class="product-cat">Rechargeable</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹149</span> <span class="prod-old">â‚¹229</span></div>
                    <div class="rating">â˜… 4.6 (301)</div>
                </div>
            </div>
        </article>

        <!-- Essentials -->
        <article class="product-card" data-cat="essentials" data-id="es1">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p5.jpg' %}" alt="">
                <div class="prod-badge">Essentials</div>
                <button class="view-btn" data-id="es1">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">Travel Neck Pillow</div>
                <div class="product-cat">Memory Foam</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹149</span> <span class="prod-old">â‚¹249</span></div>
                    <div class="rating">â˜… 4.4 (78)</div>
                </div>
            </div>
        </article>

        <article class="product-card" data-cat="essentials" data-id="es2">
            <div class="product-thumb">
                <img src="{% static 'assets/images/products/p3.jpg' %}" alt="">
                <div class="prod-badge">Essentials</div>
                <button class="view-btn" data-id="es2">View</button>
            </div>
            <div class="product-info">
                <div class="product-title">Insulated Steel Bottle</div>
                <div class="product-cat">Hot & Cold 24h</div>
                <div class="price-row">
                    <div><span class="prod-price">â‚¹199</span> <span class="prod-old">â‚¹299</span></div>
                    <div class="rating">â˜… 4.7 (212)</div>
                </div>
            </div>
        </article>

    </div>

    <!-- MODAL ROOT -->
    <div id="modalRoot"></div>
</div>

{% endblock %}


{% block extra_js %}
<script>

    (function () {

        /* ---- CATEGORY FILTER ---- */
        const tabs = document.querySelectorAll('.filter-tab');
        const cards = document.querySelectorAll('.product-card');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                const filter = tab.dataset.filter;

                cards.forEach(card => {
                    const cat = card.dataset.cat;
                    card.style.display = (filter === 'all' || filter === cat) ? '' : 'none';
                });
            });
        });

        /* ---- RENT/BUY TOGGLE ---- */
        btnRent.onclick = () => { btnRent.classList.add('active'); btnBuy.classList.remove('active'); }
        btnBuy.onclick = () => { btnBuy.classList.add('active'); btnRent.classList.remove('active'); }

        /* ---- QUICK VIEW MODAL ---- */
        const modalRoot = document.getElementById('modalRoot');

        function openModal(product) {
            modalRoot.innerHTML = `
    <div class="modal-backdrop" id="modalBG">
      <div class="quick-modal">
        <button class="close-x" id="closeX">âœ•</button>
        <div class="quick-left">
          <img src="${product.img}">
        </div>
        <div class="quick-right">
          <h2>${product.name}</h2>
          <p>${product.subtitle}</p>
          <div class="prod-price" style="font-size:24px;">â‚¹${product.price}</div>
          <p style="margin-top:10px;color:#444">${product.subtitle}</p>
          <div style="margin-top:14px;display:flex;gap:8px;">
            <button class="btn-primary">View Details</button>
            <button class="btn-outline" id="closeBtn2">Close</button>
          </div>
        </div>
      </div>
    </div>`;

            document.getElementById('modalBG').onclick = (e) => {
                if (e.target.id === 'modalBG') modalRoot.innerHTML = '';
            };
            document.getElementById('closeX').onclick = () => modalRoot.innerHTML = '';
            document.getElementById('closeBtn2').onclick = () => modalRoot.innerHTML = '';
        }

        /* ---- CREATE PRODUCT MAP ---- */
        const map = {};
        cards.forEach(card => {
            map[card.dataset.id] = {
                name: card.querySelector('.product-title').innerText,
                subtitle: card.querySelector('.product-cat').innerText,
                price: card.querySelector('.prod-price').innerText.replace('â‚¹', ''),
                img: card.querySelector('.product-thumb img').src
            };
        });

        /* ---- ATTACH MODAL CLICK ---- */
        document.getElementById('productGrid').addEventListener('click', (e) => {
            const btn = e.target.closest('.view-btn');
            if (!btn) return;
            openModal(map[btn.dataset.id]);
        });

    })();
</script>
{% endblock %}